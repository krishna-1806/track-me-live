<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TrackMe Live ‚Äì 3D Terrain Mode</title>

  <link rel="icon" type="image/png"
        href="https://cdn-icons-png.flaticon.com/512/684/684908.png" />
  <link href="https://unpkg.com/maplibre-gl@3.2.0/dist/maplibre-gl.css"
        rel="stylesheet" />

  <style>
    html,body{margin:0;height:100%;overflow:hidden;font-family:"Segoe UI",Arial,sans-serif;}
    #map{position:absolute;top:0;bottom:0;width:100%;}
    .toolbar{
      position:absolute;top:10px;left:50%;transform:translateX(-50%);
      background:rgba(43,108,176,.9);color:#fff;padding:8px 18px;
      border-radius:8px;font-weight:600;z-index:10;text-align:center;
    }
    .btn{
      position:absolute;top:10px;left:10px;
      background:#fff;color:#2b6cb0;border:none;border-radius:6px;
      padding:6px 12px;font-weight:600;cursor:pointer;z-index:10;
    }
  </style>
</head>
<body>
  <div class="toolbar">üåç TrackMe Live ‚Äì 3D Terrain View</div>
  <button class="btn" onclick="window.location.href='index.html'">‚Üê 2D View</button>
  <div id="map"></div>

  <script src="https://unpkg.com/maplibre-gl@3.2.0/dist/maplibre-gl.js"></script>
  <script>
    const MAPTILER_KEY = "YOUR_MAPTILER_KEY_HERE"; // üîë paste your key

    const map = new maplibregl.Map({
      container: "map",
      style: `https://api.maptiler.com/maps/hybrid/style.json?key=${MAPTILER_KEY}`,
      center: [78.4867, 17.3850],
      zoom: 13,
      pitch: 60,
      bearing: -20,
      antialias: true
    });

    map.addControl(new maplibregl.NavigationControl());

    // --- Enable 3D terrain
    map.on("load", () => {
      map.addSource("terrain", {
        type: "raster-dem",
        url: `https://api.maptiler.com/tiles/terrain-rgb/tiles.json?key=${MAPTILER_KEY}`,
        tileSize: 256,
        maxzoom: 14
      });
      map.setTerrain({ source: "terrain", exaggeration: 1.2 });

      // Add subtle sky
      map.addLayer({
        id: "sky",
        type: "sky",
        paint: {
          "sky-type": "atmosphere",
          "sky-atmosphere-sun": [0.0, 0.0],
          "sky-atmosphere-sun-intensity": 15
        }
      });
    });

    // --- Live GPS marker
    let gpsMarker;
    function trackGPS() {
      if (!navigator.geolocation) {
        alert("Your device doesn't support GPS tracking.");
        return;
      }
      navigator.geolocation.watchPosition(
        pos => {
          const { latitude, longitude } = pos.coords;
          if (gpsMarker) {
            gpsMarker.setLngLat([longitude, latitude]);
          } else {
            gpsMarker = new maplibregl.Marker({ color: "#ff0000" })
              .setLngLat([longitude, latitude])
              .setPopup(new maplibregl.Popup().setText("üìç You are here"))
              .addTo(map);
          }
          map.flyTo({ center: [longitude, latitude], zoom: 15, pitch: 60 });
        },
        err => alert("Unable to fetch location: " + err.message),
        { enableHighAccuracy: true, maximumAge: 0, timeout: 5000 }
      );
    }

    // Start tracking automatically
    trackGPS();
  </script>
</body>
</html>
